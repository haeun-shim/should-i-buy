# 마법의 소라고동 🐚

**"살까말까 3초 고민되면, 한 번만 눌러보세요."**

충동구매를 방지하고 합리적인 소비 습관을 만들어주는 AI 기반 의사결정 도구입니다.

## 📌 프로젝트 개요

- **이름**: 마법의 소라고동 (살까말까 판단기)
- **목표**: 8가지 질문을 통해 소비 판단을 객관적으로 분석하고 합리적인 결론 제공
- **컨셉**: 스폰지밥의 "마법의 소라고동"처럼 간단하지만 신뢰할 수 있는 답변
- **주요 기능**:
  - 🎯 8가지 질문 기반 소비 판단
  - 📊 필요성, 후회 위험, 예산 부담, 중복/유지비 점수 계산
  - ✅ 3단계 결론 (구매 OK / 48시간 보류 / 구매 비추천)
  - 💬 AI 코멘트로 상세한 이유 설명
  - 📝 소비 판단 기록 저장 및 대시보드

## 🌐 URLs

- **Production**: https://6762b4af.should-i-buy.pages.dev (최신 - 마법의 소라고동 브랜딩)
- **GitHub**: https://github.com/haeun-shim/should-i-buy
- **샌드박스 테스트**: https://3000-isq73layem4w7421edtqz-2b54fc91.sandbox.novita.ai

## 🎯 완료된 기능

### ✅ 1. 대시보드 (`/`)
- 최근 소비 판단 내역 리스트 표시
- 항목명, 가격, 결론, 카테고리, 총점 한눈에 확인
- 클릭 시 상세 결과 페이지로 이동
- **새 소비 판단하기** & **통계 보기** 버튼
- 48시간 보류 항목 섹션 (자동 표시)

### ✅ 2. 새 소비 판단 (`/new`)
- **기본 정보 입력**:
  - 항목 이름 (텍스트)
  - 가격 (숫자)
  - 카테고리 (필수/업무/취미/기타)

- **8가지 질문** (친근한 서브텍스트 포함):
  1. Q1: 없으면 얼마나 불편해? (슬라이더 0-5) - _직감으로 찍어도 괜찮아요._
  2. Q2: 비슷한 물건 있어? (예/아니오) - _집에 굴러다니는 것도 포함해요._
  3. Q3: 3개월 뒤에도 주 1회 이상 쓸까? (슬라이더 0-5) - _직감으로 찍어도 괜찮아요._
  4. Q4: 예산 부담은? (슬라이더 0-5) - _솔직하게 답해야 정확해요._
  5. Q5: 지금 내 감정 상태는? (평온/스트레스/우울/텐션 업) - _감정이 소비에 영향을 줄 수 있어요._
  6. Q6: 구매 계기는? (실제 필요/지인 추천/광고/그냥 눈에 띄어서) - _정직하게 체크해보세요._
  7. Q7: 1-2주 뒤에 사도 괜찮아? (예/아니오) - _급한 게 아니면 시간을 두고 생각해요._
  8. Q8: 추가 유지비 있어? (예/아니오/잘 모르겠음) - _숨은 비용이 있을 수 있어요._

### ✅ 3. 결과 페이지 (`/result/:id`)
- **결론 카드**: 이모지와 함께 명확한 결론 표시
- **점수 상세**:
  - 필요성 점수 (N): Q1 * 2 + Q3 * 1.5 + 중복 보너스
  - 후회 위험 (R): 감정 상태 + 구매 계기 + 대기 가능 여부
  - 예산 부담 (B): Q4 * 2
  - 중복/유지비 (D): 비슷한 물건 + 추가 비용
  - 총점 (T): N - R - B - D
- **AI 코멘트**: 점수 근거를 자세히 설명
- **소셜 공유**: 카카오톡, 트위터, 페이스북, 링크 복사
- **액션**: 대시보드 이동, 새로 판단하기, 삭제

### ✅ 4. 통계 대시보드 (`/stats`) 🆕
- **요약 카드**: 총 판단 횟수, 구매 완료, 보류, 비추천
- **금액 통계**: 총 고려 금액, 절약한 금액, 절약률
- **결론 분포 차트**: 도넛 차트로 시각화
- **최근 활동**: 7일/30일 통계
- **카테고리별 분석**: 카테고리별 건수, 금액, 평균 점수
- **월별 트렌드**: 월별 소비 패턴 분석

### ✅ 5. 48시간 보류 알림 🆕
- **브라우저 알림**: 48시간 후 자동 리마인더
- **로컬 스토리지**: 보류 항목 자동 저장
- **보류 섹션**: 대시보드에 남은 시간 표시
- **알림 권한 요청**: 사용자 친화적 프롬프트

### ✅ 6. RESTful API
- `GET /api/decisions` - 전체 기록 조회
- `GET /api/decisions/:id` - 특정 기록 조회
- `POST /api/decisions` - 새 판단 생성
- `DELETE /api/decisions/:id` - 기록 삭제
- `GET /api/statistics` - 통계 데이터 조회 🆕

## 🏗️ 데이터 아키텍처

### 데이터 모델
```typescript
PurchaseDecision {
  // 기본 정보
  id: number
  item_name: string
  price: number
  category: '필수' | '업무' | '취미' | '기타'
  
  // 질문 답변 (Q1-Q8)
  q1_necessity: number (0-5)
  q2_has_similar: '예' | '아니오'
  q3_future_use: number (0-5)
  q4_budget_burden: number (0-5)
  q5_emotional_state: '평온' | '스트레스' | '우울' | '텐션 업'
  q6_purchase_trigger: '실제 필요' | '지인 추천' | '광고·SNS 보고' | '그냥 눈에 띄어서'
  q7_can_wait: '예' | '아니오'
  q8_maintenance_cost: '예' | '아니오' | '잘 모르겠음'
  
  // 계산된 점수
  necessity_score: number
  regret_risk: number
  budget_burden: number
  duplicate_cost: number
  total_score: number
  
  // 결론 및 코멘트
  conclusion: '구매 OK' | '48시간 보류' | '구매 비추천'
  comments: string
  
  // 타임스탬프
  created_at: string
  updated_at: string
}
```

### 저장소 서비스
- **Cloudflare D1**: SQLite 기반 관계형 데이터베이스
- **로컬 개발**: `.wrangler/state/v3/d1` 디렉토리에 로컬 SQLite 사용
- **프로덕션**: Cloudflare D1 클라우드 데이터베이스

### 데이터 흐름
1. 사용자가 `/new` 페이지에서 8가지 질문 답변
2. 프론트엔드가 `POST /api/decisions` 호출
3. 백엔드의 `scoreCalculator.ts`가 점수 계산 알고리즘 실행
4. D1 데이터베이스에 결과 저장
5. 생성된 ID로 `/result/:id` 페이지 리다이렉트
6. 대시보드에서 모든 기록 조회 가능

## 🧮 점수 계산 알고리즘

```
필요성 점수 (N) = Q1 * 2 + Q3 * 1.5 + (Q2=="아니오" ? 3 : 0)
후회 위험 (R) = 감정상태 가중치 + 구매계기 가중치 + (Q7=="아니오" ? -2 : 2)
예산 부담 (B) = Q4 * 2
중복/유지비 (D) = (Q2=="예" ? 3 : 0) + (Q8=="예" ? 2 : "잘 모르겠음" ? 1 : 0)

총점 (T) = N - R - B - D

결론:
- T >= 5 → ✅ 구매 OK (합리적인 소비)
- 0 <= T < 5 → ⏳ 48시간 보류 (신중히 고민)
- T < 0 → ❌ 구매 비추천 (후회 가능성 높음)
```

### 감정 상태 가중치
- 평온: 0
- 스트레스: 3
- 우울: 4
- 텐션 업: 3

### 구매 계기 가중치
- 실제 필요: 0
- 지인 추천: 1
- 광고·SNS 보고: 3
- 그냥 눈에 띄어서: 4

## 📖 사용자 가이드

### 1. 새 소비 판단하기
1. 대시보드에서 "새 소비 판단하기" 버튼 클릭
2. 구매하려는 물건 정보 입력 (이름, 가격, 카테고리)
3. 8가지 질문에 솔직하게 답변
4. "판단하기" 버튼 클릭
5. 10초 안에 결과 확인!

### 2. 결과 해석하기
- **✅ 구매 OK**: 합리적인 소비입니다. 자신감 있게 구매하세요!
- **⏳ 48시간 보류**: 조금 더 신중하게 고민해보세요. 48시간 후 다시 생각해보면 더 명확한 답이 나올 수 있습니다.
- **❌ 구매 비추천**: 후회할 가능성이 높습니다. 다른 대안을 찾거나 구매를 미루는 것이 좋겠습니다.

### 3. 과거 기록 확인하기
- 대시보드에서 과거 소비 판단 기록들을 확인할 수 있습니다
- 각 기록을 클릭하면 상세 결과를 다시 볼 수 있습니다
- 불필요한 기록은 삭제할 수 있습니다

## 🚀 배포 상태

- **플랫폼**: Cloudflare Pages + Cloudflare D1
- **현재 상태**: ✅ 프로덕션 배포 완료 (v2.0 - Phase 1-3 포함)
- **Tech Stack**:
  - Backend: Hono (Cloudflare Workers)
  - Frontend: Vanilla JavaScript + Tailwind CSS
  - Database: Cloudflare D1 (SQLite)
  - Analytics: Google Analytics 4
  - Notifications: Browser Push API
  - Deployment: Cloudflare Pages
- **마지막 업데이트**: 2025-12-03 (Phase 1-3 기능 추가)
- **프로젝트 통계**:
  - 📁 파일 수: 20개 (JS/TS/HTML/CSS/SQL)
  - 📊 코드 라인: ~2,500 lines
  - 🗄️ 데이터베이스: 1개 (Cloudflare D1 - webapp-production)
  - 🔌 API 엔드포인트: 5개
  - 🎨 페이지: 4개 (대시보드, 새 판단, 결과, 통계)

## 🔨 로컬 개발

### 필수 조건
- Node.js 18+
- npm

### 설치 및 실행
```bash
# 의존성 설치
npm install

# 데이터베이스 마이그레이션
npm run db:migrate:local

# 샘플 데이터 삽입
npm run db:seed

# 빌드
npm run build

# 개발 서버 시작 (PM2)
pm2 start ecosystem.config.cjs

# 테스트
curl http://localhost:3000
```

### 유용한 명령어
```bash
# 데이터베이스 초기화
npm run db:reset

# 로컬 D1 콘솔
npm run db:console:local

# 포트 정리
npm run clean-port

# Git 커밋
npm run git:commit "message"
```

## 🆕 최근 추가된 기능 (Phase 1-3)

### Phase 1: 사용자 통계 대시보드 ✅
- **통계 페이지 (`/stats`)**: 전체 소비 판단 데이터 시각화
- **절약 금액 계산**: "48시간 보류"와 "구매 비추천" 항목 합산
- **카테고리별 분석**: 필수/업무/취미/기타 각 카테고리별 통계
- **월별 트렌드**: 최근 12개월 소비 패턴 시각화

### Phase 2: 소셜 공유 기능 ✅
- **결과 페이지 공유**: 카카오톡, 트위터, 페이스북
- **링크 복사**: 원클릭 URL 복사 기능
- **공유 메시지 자동 생성**: "나는 [항목명]을 [결론]으로 판단했어요!"

### Phase 3: 48시간 보류 알림 & 분석 도구 ✅
- **브라우저 푸시 알림**: 보류 항목 48시간 후 자동 리마인더
- **로컬 스토리지 활용**: 서버 부하 없이 클라이언트 기반 알림
- **Google Analytics 통합**: 사용자 행동 분석 및 인사이트
- **대시보드 보류 섹션**: 남은 시간 카운트다운 표시

## 📋 아직 구현되지 않은 기능

### 추가 예정 기능
1. **사용자 인증**: 개인별 소비 기록 관리 (Firebase Auth / Clerk)
2. **예산 설정**: 월간 예산 설정 및 추적
3. **모바일 앱**: React Native로 모바일 앱 버전
4. **AI 챗봇**: 소비 고민 상담 챗봇 (GPT-4 기반)
5. **커뮤니티 기능**: 다른 사용자의 소비 판단 사례 공유

### 개선 예정 사항
1. **점수 알고리즘 정밀화**: 더 많은 데이터로 가중치 최적화
2. **반응형 디자인 개선**: 모바일 UX 개선
3. **다국어 지원**: 영어, 일본어 등 다국어 지원
4. **다크 모드**: 야간 사용을 위한 다크 모드
5. **오프라인 모드**: PWA 기반 오프라인 지원

## 🔜 권장 다음 단계

1. ✅ **Cloudflare Pages 배포 완료**: https://6b3c27d3.should-i-buy.pages.dev
2. ✅ **D1 프로덕션 데이터베이스**: webapp-production (ID: 1ec0fdc2-4976-4eda-8dc9-8ee8e0ec6785)
3. ✅ **GitHub 저장소 연동**: https://github.com/haeun-shim/should-i-buy
4. **커스텀 도메인 연결**: should-i-buy.com (선택 사항)
5. **Google Analytics 추적 코드 추가**: GA4 Property 생성 및 측정 ID 설정
6. **사용자 피드백 수집**: 실제 사용자 의견 반영
7. **A/B 테스트**: 점수 계산 알고리즘 최적화
8. **성능 모니터링**: Cloudflare Analytics로 트래픽 분석

## 🎨 디자인 철학

- **심플함**: 복잡한 설정 없이 즉시 사용 가능
- **직관적**: 누구나 이해할 수 있는 질문과 결과
- **객관적**: 감정이 아닌 데이터 기반 의사결정
- **친근함**: 따뜻한 색상과 이모지로 친근한 UI
- **위트**: "마법의 소라고동"이라는 유쾌한 브랜딩으로 부담 없는 접근
- **격려**: "직감으로 찍어도 괜찮아요" 같은 친절한 가이드 메시지

## 📄 라이선스

MIT License

## 👩‍💻 개발자

- **하은님**을 위한 맞춤형 소비 판단 도구
- 임상팀 전문가의 데이터 기반 사고방식을 반영
- 폴댄스, 클라이밍, AI 탐구에 이어 합리적 소비 습관까지!

---

**🐚 Tip**: 충동구매가 고민이라면, 지금 바로 "마법의 소라고동"에게 물어보세요! 3초면 충분합니다.
